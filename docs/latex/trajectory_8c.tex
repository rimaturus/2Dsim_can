\hypertarget{trajectory_8c}{}\doxysection{src/trajectory.c File Reference}
\label{trajectory_8c}\index{src/trajectory.c@{src/trajectory.c}}


Implements trajectory planning based on detected cones.  


{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include \char`\"{}trajectory.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}globals.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}perception.\+h\char`\"{}}\newline
Include dependency graph for trajectory.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trajectory_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{trajectory_8c_a919f2f0e87ab763cdae69585d089d23d}{trajectory\+\_\+planning}} (float \mbox{\hyperlink{globals_8c_a4a4a6918df3caa78a889c76207349a02}{car\+\_\+x}}, float \mbox{\hyperlink{globals_8c_a2ff6267ace75a40353ce62fdb02b9e67}{car\+\_\+y}}, float \mbox{\hyperlink{globals_8c_ad9878a31df3b8d7db61cf55b7eb07cd4}{car\+\_\+angle}}, \mbox{\hyperlink{structcone}{cone}} $\ast$\mbox{\hyperlink{group__PerceptionModule_gaab5237f191baaef95b94ad0686b40aa6}{detected\+\_\+cones}}, \mbox{\hyperlink{structwaypoint}{waypoint}} $\ast$\mbox{\hyperlink{trajectory_8c_a525ffa7b5c81396c8024ff1f8d9e7015}{trajectory}})
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{trajectory_8c_ae029a650d6946f8d6ef67dda76e488c6}{trajectory\+\_\+idx}} = 0
\begin{DoxyCompactList}\small\item\em Global index used to track the number of waypoints currently stored in the trajectory. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structwaypoint}{waypoint}} \mbox{\hyperlink{trajectory_8c_a525ffa7b5c81396c8024ff1f8d9e7015}{trajectory}} \mbox{[}2 $\ast$\mbox{\hyperlink{globals_8h_ac5ffab41ad229777dae06978b9a7bc15}{MAX\+\_\+\+DETECTED\+\_\+\+CONES}}\mbox{]}
\begin{DoxyCompactList}\small\item\em Global array of waypoints forming the planned trajectory. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implements trajectory planning based on detected cones. 

This file contains the functionality to plan a driving trajectory using cone detection data. The trajectory is generated by connecting a global track map of cones (both blue and yellow) based on their proximity, and then finding midpoints between connected cones to serve as trajectory waypoints. Optionally, in debug builds, the cone connections are drawn for visualization.

Global Variables\+:
\begin{DoxyItemize}
\item trajectory\+\_\+idx\+: An integer index representing the number of valid points in the generated trajectory.
\item trajectory\+: An array of waypoints that stores the planned trajectory.
\end{DoxyItemize}

The trajectory planning process includes\+:
\begin{DoxyItemize}
\item Initializing trajectory points with invalid default values.
\item Validating if there are enough cones in the track map to perform planning.
\item Computing nearest neighbors for each cone (one for each color) for connection building.
\item Drawing connection lines between cones when debugging is enabled.
\item Generating trajectory waypoints by calculating the midpoint between connected cones.
\item Reordering trajectory points based on proximity to ensure a smooth and sequential path.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em car\+\_\+x} & The current x-\/coordinate of the car. \\
\hline
{\em car\+\_\+y} & The current y-\/coordinate of the car. \\
\hline
{\em car\+\_\+angle} & The current orientation angle of the car in radians. \\
\hline
{\em detected\+\_\+cones} & Pointer to an array of cones detected by the car\textquotesingle{}s perception system. \\
\hline
{\em trajectory} & Pointer to an array of waypoints where the computed trajectory will be stored.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item The function assumes that there exists a correctly maintained global track map (track\+\_\+map) and its size (track\+\_\+map\+\_\+idx).
\item Debug drawing of cone connections is enclosed in an \#ifdef DEBUG block.
\item The maximum number of trajectory points is defined by MAX\+\_\+\+DETECTED\+\_\+\+CONES.
\end{DoxyItemize}
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
Ensure proper initialization of global variables and suitable allocation of the trajectory array before invoking this function. 
\end{DoxyWarning}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{trajectory_8c_a919f2f0e87ab763cdae69585d089d23d}\label{trajectory_8c_a919f2f0e87ab763cdae69585d089d23d}} 
\index{trajectory.c@{trajectory.c}!trajectory\_planning@{trajectory\_planning}}
\index{trajectory\_planning@{trajectory\_planning}!trajectory.c@{trajectory.c}}
\doxysubsubsection{\texorpdfstring{trajectory\_planning()}{trajectory\_planning()}}
{\footnotesize\ttfamily void trajectory\+\_\+planning (\begin{DoxyParamCaption}\item[{float}]{car\+\_\+x,  }\item[{float}]{car\+\_\+y,  }\item[{float}]{car\+\_\+angle,  }\item[{\mbox{\hyperlink{structcone}{cone}} $\ast$}]{detected\+\_\+cones,  }\item[{\mbox{\hyperlink{structwaypoint}{waypoint}} $\ast$}]{trajectory }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{trajectory_8c_a919f2f0e87ab763cdae69585d089d23d_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{trajectory_8c_a525ffa7b5c81396c8024ff1f8d9e7015}\label{trajectory_8c_a525ffa7b5c81396c8024ff1f8d9e7015}} 
\index{trajectory.c@{trajectory.c}!trajectory@{trajectory}}
\index{trajectory@{trajectory}!trajectory.c@{trajectory.c}}
\doxysubsubsection{\texorpdfstring{trajectory}{trajectory}}
{\footnotesize\ttfamily \mbox{\hyperlink{structwaypoint}{waypoint}} trajectory\mbox{[}2 $\ast$\mbox{\hyperlink{globals_8h_ac5ffab41ad229777dae06978b9a7bc15}{MAX\+\_\+\+DETECTED\+\_\+\+CONES}}\mbox{]}}



Global array of waypoints forming the planned trajectory. 

This array stores the computed trajectory based on the detected cones. It is sized to accommodate up to twice the number of maximum detectable cones (2 $\ast$ MAX\+\_\+\+DETECTED\+\_\+\+CONES). \mbox{\Hypertarget{trajectory_8c_ae029a650d6946f8d6ef67dda76e488c6}\label{trajectory_8c_ae029a650d6946f8d6ef67dda76e488c6}} 
\index{trajectory.c@{trajectory.c}!trajectory\_idx@{trajectory\_idx}}
\index{trajectory\_idx@{trajectory\_idx}!trajectory.c@{trajectory.c}}
\doxysubsubsection{\texorpdfstring{trajectory\_idx}{trajectory\_idx}}
{\footnotesize\ttfamily int trajectory\+\_\+idx = 0}



Global index used to track the number of waypoints currently stored in the trajectory. 

This variable indicates the current position in the trajectory array, facilitating the addition of new waypoints. 